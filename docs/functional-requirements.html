<html>
	<head>
		<title>Functional Requirements</title>
		<link rel="stylesheet" type="text/css" href="css/functional-requirements.css">
		<link rel="stylesheet" type="text/css" href="css/documentation.css">
	</head>
	<body>
		<span class='center'>
		<h1 class='title no-gaps dark-text'>CYOAG</h1>
		<h3 class='no-gaps darker-text'>Choose Your Own Adventure Game</h3>
		<p class='no-gaps darker-text'>A user-generated text-adventure</p>
		</span>

		<ol>
			<li class='header'>
				<hr>
				<a name='0'></a>
				<h2>Table of Contents</h2><br>
				<ol id='toc-internal'>
					<li><a href='#0'>Table of Contents</a></li>
					<li><a href='#1'>Project Statement</a></li>
					<li><a href='#1'>Document Iterations</a></li>
					<li><a href='#3'>Definitions</a></li>
					<li><a href='#4'>Basic Feature Families</a></li>
					<li><a href='#5'>User Stories</a></li>
					<li><a href='#6'>Explicit Restrictions</a></li>
					<li><a href='#7'>Detailed Votification Rules</a></li>
					<li><a href='#8'>Architecture and Technology Stack</a></li>
					<li><a href='#9'>Data Model</a></li>
					<li><a href='#10'>Stretch Goals</a></li>
				</ol><br>
			</li>

			<li class='header'>
				<hr>
				<a name='1'></a>
				<h2>Project Statement</h2>
				<p>Choose Your Own Adventure Game, or CYOAG for short, is an idea Steven Kitzes came up with, based on the choose-your- own-adventure books he grew up with. The basic idea behind these books was that the reader would be presented with very short chapters for context; then get to pick from a handful of options leading to different page numbers, ultimately resulting in different paths through a story that always started the same but had many possible endings.  Steven enjoyed reading, and was thrilled to discover books with variable outcomes.</p>
				<p>Now, later in life, Steven has come to love writing as much as he loves reading. Having grown into a career in software development, and remembering his love of choose-your-own-adventure books, he decided it would be a great potential side project to build a website that combines all of these loves into one. The CYOAG is, thus, a web app that proposes to let users read and/or create content for a choose-your- own-adventure game online. This broad-strokes definition will be described in much greater detail throughout this document.</p>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='2'></a>
				<h2>Document Iterations</h2>
				<p>Changes made to this document are as follows:</p>
				<table id='iterations' class='dark-border light-rounding'>
					<tr>
						<td class='bold'>Author</td>
						<td class='bold'>Date</td>
						<td class='bold'>Version</td>
						<td class='bold'>Changes</td>
					</tr>
					<tr>
						<td>Steven Kitzes</td>
						<td>2016.07.24</td>
						<td>0.1.2</td>
						<td>First documented update; includes Document iteration main section; new Definitions entries for downvote, moderator, RDBMS, UID, upvote, and votification; new Basic Feature Family entry for Moderator intervention; new Explicit Restriction entry for Path snippet content; new main section for Detailed Votification Rules; and content for the Architecture and Technology Stack, and Data Model main sections.</td>
					</tr>
					<tr>
						<td>Steven Kitzes</td>
						<td>2016.07.24</td>
						<td>0.2.0</td>
						<td>Migrating to HTML since my MS Office license was revoked and I'm bitter about it, and HTML is a better format for versioning anyway.  Detailed Votification Rules main section fleshed out.  Stretch Goals main section added.</td>
					</tr>
					<tr>
						<td>Steven Kitzes</td>
						<td>2016.07.27</td>
						<td>0.2.1</td>
						<td>Beginning HTML refactor; no content change, just separating CSS to dedicated file, and beginning effort to improve HTML-correctness.</td>
					</tr>
					<tr>
						<td>Steven Kitzes</td>
						<td>2016.07.28</td>
						<td>1.0.0</td>
						<td>First draft, design complete until development, consultation, and discovery necessitate changes.  Separated CSS into two files, one for general documentation use, the other one specific to our functional-requirements.html file.  Refactored HTML and CSS for much cleaner, safer, maintainable, expandable project.</td>
					</tr>
					<tr>
						<td>Steven Kitzes</td>
						<td>2016.07.30</td>
						<td>1.0.1</td>
						<td>Colors and styling updated, no content updates or additions.</td>
					</tr>
				</table>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='3'></a>
				<h2>Definitions</h2>
				<p>The following terms used throughout this document warrant further explanation:</p>
				<table id='definitions' class='dark-border light-rounding'>
					<tr>
						<td class='bold'>Term</td>
						<td class='bold'>Definition</td>
					</tr>
					<tr>
						<td>account</td>
						<td>Unless otherwise specified, a CYOAG account. Not to be confused with a linked social media account, which in this document shall be referred to as such to prevent confusion.</td>
					</tr>
					<tr>
						<td>AMI</td>
						<td>Amazon Machine Image - a virtual machine image provided by Amazon AWS for hosting web services.</td>
					</tr>
					<tr>
						<td>child</td>
						<td>Any node, reachable via a path, that follows immediately after the current node.</td>
					</tr>
					<tr>
						<td>CYOAG</td>
						<td>Create Your Own Adventure Game - the name of this web application.</td>
					</tr>
					<tr>
						<td>downvote</td>
						<td>A vote by a user against a specific node, indicating negative sentiment.</td>
					</tr>
					<tr>
						<td>moderator</td>
						<td>A user with a CYOAG <a href="www.google.com">account</a> linked to a social media account, and who has special privileges granted for purposes of editing or removing content that violates site usage guidelines (e.g. a story snippet containing spam, or other abusive site usage).</td>
					</tr>
					<tr>
						<td>node</td>
						<td>A collection of all data representing a particular point in the story. This includes snippet and ID data for the current part of the story, the current node's parent, and zero or more paths.</td>
					</tr>
					<tr>
						<td>node ID</td>
						<td>The UID of the current node.</td>
					</tr>
					<tr>
						<td>node snippet</td>
						<td>The main story content (prose) at the current node.</td>
					</tr>
					<tr>
						<td>parent</td>
						<td>The node immediately preceding the current node; in other words, the current node is reachable via a path from the parent.</td>
					</tr>
					<tr>
						<td>path</td>
						<td>One option (usually of several) for story progression, leading away from the current node toward another, subsequent node.</td>
					</tr>
					<tr>
						<td>path snippet</td>
						<td>A short piece of text describing one of a reader's potential choices for progressing the story past the current node. Note that a given node's path snippet is displayed with that node's parent, to provide an option for progression that leads from said parent to the current node.</td>
					</tr>
					<tr>
						<td>RDBMS</td>
						<td>Relational database management system - a technology for defining and constructing a database, and maintaining data therein; e.g. MySQL.</td>
					</tr>
					<tr>
						<td>root node</td>
						<td>The very first node of the story, provided free of charge by Steven Kitzes, from which all paths and subsequent nodes follow.</td>
					</tr>
					<tr>
						<td>trajectory</td>
						<td>A complete series of paths leading from the root node all the way to the current node.</td>
					</tr>
					<tr>
						<td>UID</td>
						<td>Unique identifier - a randomly generated string with astronomically small odds of a collision.</td>
					</tr>
					<tr>
						<td>upvote</td>
						<td>A vote by a user in favor of a specific node, indicating positive sentiment.</td>
					</tr>
					<tr>
						<td>user ID</td>
						<td>A user's UID.</td>
					</tr>
					<tr>
						<td>votify, votified, votification</td>
						<td>A promoted node state that ensures the path to said node will be visible as a primary choice from that node's parent; this promotion occurs when user votes raise a node's vote count higher than its siblings, and can be a default state in the case that a node has few or no siblings.</td>
					</tr>
				</table>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='4'></a>
				<h2>Basic Feature Families</h2>
				<p>Observing this application at a high level, the following basic features are proposed (with further details provided later in this document):</p>
				<ol>
					<li class='subheader'>
						<h2>Read the story</h2>
						<p><strong>Any user</strong> visiting the site shall be able to read the story, making path selections to progress as far through the story as desired without needing an account.</p>
					</li>
					<li class='subheader'>
						<h2>User accounts</h2>
						<p><strong>Any user</strong> shall be able to create and log into a CYOAG account by associating a social media account.</p>
					</li>
					<li class='subheader'>
						<h2>Continuation</h2>
						<p><strong>Any user</strong> with cookies enabled shall be able to pick up where the story left off if they stop reading in the middle of a trajectory.</p>
					</li>
					<li class='subheader'>
						<h2>Contribution</h2>
						<p><strong>Any user</strong> who is logged in shall be able to create new paths, leading to new story nodes from existing nodes.</p>
					</li>
					<li class='subheader'>
						<h2>Votification</h2>
						<p><strong>Any user</strong> who is logged in shall be able to apply positive or negative reversible sentiment to any node to which they have navigated.</p>
					</li>
					<li class='subheader'>
						<h2>Moderator intervention</h2>
						<p><strong>A moderator</strong> shall have special privileges granted for the purposes of improving quality (e.g. correcting typos) and enforcing CYOAG rules and guidelines (e.g. removing spam or other abusive content). This includes modifying content posted by users, deleting content, and blocking users from posting new content, but does not include the ability to override content contribution rules (e.g. a moderator may not contribute multiple paths to a node or contribute consecutive nodes).</p>
					</li>
				</ol>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='5'></a>
				<h2>User Stories</h2>
				<p>The following specific use cases elaborate and expand on the Basic Feature Families described above.</p>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='6'></a>
				<h2>Explicit Restrictions</h2>
				<p>There are certain behaviors we want to disallow to prevent users from abusing the site or acting without the spirit of collaboration in mind. These behaviors are prevented or limited by design.</p>
				<ol>
					<li class='subheader'>
						<h2>Editing</h2>
						<p>Edits to a node (including its node snippet and path snippet) shall be allowed only by that node's original creator, and only if that node has zero child nodes.  This is to prevent changes from breaking story continuity or altering the flow of the story as interpreted by subsequent authors.  <em>Exception: moderators can always edit any post.</em></p>
					</li>
					<li class='subheader'>
						<h2>Deletion</h2>
						<p>Only a node's creator shall be able to delete it, and only if that node has no child nodes yet.  <em>Exception: moderators can always delete any post; deletions must cascade to child nodes to prevent database deletion.</em></p>
					</li>
					<li class='subheader'>
						<h2>Sibling paths</h2>
						<p>No user shall be permitted to contribute more than a single path to any node.  <em>No exception for moderators.</em></p>
					</li>
					<li class='subheader'>
						<h2>Consecutive paths</h2>
						<p>A user shall not be permitted to contribute a path to a node that was created by that same user.  <em>No exception for moderators.</em></p>
					</li>
					<li class='subheader'>
						<h2>Snippet length</h2>
						<p>A node snippet shall have a minimum length of 250 characters, and a maximum length of 1,000 characters. A path snippet shall have a minimum length of 3 characters, and a maximum length of 100 characters.  <em>No exception for moderators.</em></p>
					</li>
					<li class='subheader'>
						<h2>Path snippet content</h2>
						<p>A path snippet shall not have the same content as another path snippet at the same node.  <em>No exception for moderators.</em></p>
					</li>
					<li class='subheader'>
						<h2>Narcissistic votification</h2>
						<p>No user shall be able to vote (either up or down) for their own nodes.  <em>No exception for moderators.</em></p>
					</li>
				</ol>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='7'></a>
				<h2>Detailed Votification Rules</h2>
				<p>Votification is the system by which sibling nodes are promoted to, or demoted from, the status of being a primary path choice from a given parent. Here are detailed the system of rules governing votification promotion, demotion, and the effects this state has on the user experience.</p>
				<ol>
					<li class='subheader'>
						<h2>Impact of user type on votification access</h2>
						<p>Users without accounts shall be restricted from access to votification features. These unaccounted users shall be shown:</p>
						<ul>
							<li>only votified paths at the current node</li>
							<li>votification buttons that are grayed out</li>
							<li>a suggestion alongside grayed out votification UI that the user either login or create an account by linking a social media account</li>
							<li>grayed out and disabled input fields for adding paths to the current node</li>
						</ul>
						<p>Users with accounts shall have access to all public-facing votification features.  These accounted users shall be shown:</p>
						<ul>
							<li>all votified paths at the current node</li>
							<li>active votification buttons that both reflect, and allow changes to, the user's votification of the current node</li>
							<li>an option to view all paths available at a current node, not limited to votified paths; and to follow any path the user desires</li>
						</ul>
						<p>Moderators shall have access to all of the features available to accounted users.  the only difference in the moderator's experience is that all paths are always displayed for moderators.  This is to enable moderators quicker navigation and easier skimming of path snippets.</p>
					</li>
					<li class='subheader'>
						<h2>Detailed definition of votified paths</h2>
						<p>The top 4 highest voted paths out from a given node are defined as that node's votified paths.  If 4 or fewer paths exist in total at a given node, then those 4 or fewer paths are automatically taken as the votified paths for that node.  It is possible for a path to have user sentiment that is overall negative, but still to be votified, as long as that path is either in the top 4 paths overall at its parent node, or is one of 4 or fewer total paths at said parent.  In the case of a tie between two paths competing for votification, a winner will be selected arbitrarily as the votified path.</p>
					</li>
				</ol>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='8'></a>
				<h2>Architecture and Technology Stack</h2>
				<p>The desire to get the CYOAG project off the ground using the AWS Free Tier services will limit the technologies available. However, with the technologies made available through the AWS Free Tier, all requirements are achievable.</p>
				<ol>
					<li class='subheader'>
						<h2>Server</h2>
						<p>The server shall be a Node.js instance, running on a Linux AMI on Amazon EC2.</p>
					</li>
					<li class='subheader'>
						<h2>Database</h2>
						<p>The AWS Free Tier provides only relational database technologies, so NoSQL solutions are not available. Therefore, data shall be managed using MySQL due to availability and developer familiarity.</p>
					</li>
					<li class='subheader'>
						<h2>Static file service</h2>
						<p>CYOAG static files shall be served from an Amazon S3 bucket.</p>
					</li>
					<li class='subheader'>
						<h2>Front end</h2>
						<p>The CYOAG front end shall be delivered as a mixture of traditional vanilla HTML, CSS, and JavaScript with a templating technology to limit code duplication. As of this writing, Handlebars is the most likely candidate for use as a templating technology. In order to reduce the load on the Amazon S3 bucket (identified as a weak point in the AWS Free Tier service stack), jQuery shall be used extensively to manipulate DOM elements to modify the user interface, rather than loading a new static file for each navigation request by a user.</p>
					</li>
				</ol>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='9'></a>
				<h2>Data Model</h2>
				<p>Since the AWS Free Tier limits database technology options to RDBMS selections only (as of this writing), and since CYOAG has thus been designed to utilize MySQL, data shall be organized into a table structure. Data shall be divided into a number of tables to accommodate the limitations and requirements of relational database schemas, and to facilitate project organization and separation of concerns to the extent possible.  (See <a href="https://dev.mysql.com/doc/">MySQL</a>'s documentation for more details.)</p>
				<ol>
					<li class='subheader'>
						<h2>Table: users</h2>
						<p>The users table shall contain information defining and pertaining to specific user accounts. Since login duties for CYOAG are designed to be offloaded to third party authentication services such as Facebook and Google+, this table shall contain minimal information, including a unique identifier (UID) linked to an email address provided by the third party authenticator; after which point, all user identification shall be done through the UID and cookies.</p>
					</li>
					<li class='subheader'>
						<h2>Table: nodes</h2>
						<p>The nodes table shall contain information defining a given node, but not information defining relationships between nodes or defining user sentiment toward a node. In other words, this table shall contain a node's node snippet, path snippet, snippet UID, and author UID; but it shall not contain information on a node's parent, children, upvotes, or downvotes.</p>
					</li>
					<li class='subheader'>
						<h2>Table: lineage</h2>
						<p>The lineage table shall define the familial relationships between nodes. In other words, a row in the lineage table shall define the relationship between two single nodes, a parent and a child. It is worth noting that in this particular table, the primary key will need to be the UID of the child in the relationship. This is because logically a child node in the CYOAG tree structure can only ever have one parent; whereas a parent can have several children.</p>
					</li>
					<li class='subheader'>
						<h2>Table: votes</h2>
						<p>The votes table shall contain data relating user sentiment to the nodes for which that sentiment is expressed. Each row shall contain as a compound primary key a user UID and a node UID, so that each such combination is unique, preventing a user from casting multiple votes on the same node. Each row shall contain as a third datum a flag defining the user's sentiment as positive or negative. This flag can be switched in order to reflect a change in sentiment, or an entire row can be deleted to reflect a user's desire to express no sentiment on a node.</p>
					</li>
				</ol>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<li class='header'>
				<hr>
				<a name='10'></a>
				<h2>Stretch Goals</h2>
				<p>All of the essential mission objectives of the CYOAG project have been listed in the above sections of this document.  If all of the above objectives are met, the project will be a great success.  There are some additional objectives, however, that have been identified as nice to have, if they prove feasible to implement.</p>
				<ol>
					<li class='subheader'>
						<h2>Additional root nodes</h2>
						<p>With a single root node, all trajectories must launch from the same place.  If more root nodes are made available, then there are more opportunities for a variety of trajectories to develop, each with different tone, genre, etc.  Depending on the balance between user interest and moderator availability, it may even be possible to accept user submissions for new root nodes.</p>
					</li>
				</ol>
				<p class='note'><a href='#0'>back to top</a></p>
			</li>

			<hr>

		</ol>
	</body>
</html>
